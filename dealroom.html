<html>
<head>

    <link type="text/css" href="css/custom-theme/jquery-ui-1.8.16.custom.css" rel="stylesheet"/>
    <link type="text/css" href="css/custom-theme/jive-elements.css" rel="stylesheet"/>
    <link type="text/css" href="css/custom-theme/jive-icons.css" rel="stylesheet"/>
    <link type="text/css" href="css/security-groups.css" rel="stylesheet"/>

    <script type="text/javascript">

// Flag indicating we are in add mode
var adding = true;

// Currently selected group
var group;

// Factory for mini messages
var mini;

// Viewer
var viewer;

// On view load, wire up static actions and retrieve initial data
function init() {
    osapi.jive.corev3.people.getViewer({}).execute(function(response) {});
    $("#group-create-button").click(onGroupSave);
    mini = new gadgets.MiniMessage();
}


function onGroupAdded(response) {
    console.log (response);
    if (response.error) {
        mini.createDismissibleMessage("Error creating new social group: " + response.error.message);
    }
}

function onGroupSave() {
    group = {
        displayName : "",
        description : "",
        followerCount : 0,
        groupType : "",
        memberCount : 0,
        name : "",
        type : "group"
    };
    group.description = $("#group-name").val();
    group.description = "This is a deal room created for discussing " + group.description;
    group.displayName = $("#group-name").val();
    group.groupType = "PRIVATE";
    group.name = $("#group-name").val();
    if (adding) {
        osapi.jive.corev3.groups.create(group).execute(onGroupAdded);
    }
}

// Register our on-view-load handler
gadgets.util.registerOnLoadHandler(init);
</script>

</head>

<body>
<div id="wrapper">
    <div id="group-div" class="top-level-div">
        <h3 id="group-header"></h3>
        <table class="j-table">
            <tr>
                <th>Deal Room Name:</th>
                <td>
                    <input id="group-name" class="group-input" type="text" size=50/>
                </td>
            </tr>
            <tr>
                <th>&nbsp;</th>
                <td>
                    <button id="group-create-button">Create</button>
                </td>
            </tr>
        </table>
    </div>
</div>
</body>
</html>